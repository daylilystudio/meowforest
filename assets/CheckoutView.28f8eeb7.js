import{S}from"./ShopLayout.ac093d02.js";import{a as C,o as j,J as p,c as k,d as b,h as N,w as V,f as e,i as r,k as i,K as d,e as y,l as v,p as A,m as T}from"./index.9e914852.js";import{a as I}from"./api.a81b7417.js";import{u as B}from"./global.ead6d293.js";import{_ as O}from"./_plugin-vue_export-helper.cdc0426e.js";import"./TheHeader.13424155.js";const M={components:{ShopLayout:S},setup(){const s=C(),t=B();j(()=>{var o;(((o=t.cart.carts)==null?void 0:o.length)===0||t.payment===""||t.shipping==="")&&(s.push("/"),window.$message.warning("Plz Add item first"))});const x=async()=>{const o={data:{user:{name:t.userInfo.name,email:t.userInfo.email,tel:t.userInfo.tel,address:t.userInfo.add,payment_method:t.payment,shipping_method:t.shipping,shipping_money:t.shippingMoney,discount:t.cart.total-Math.ceil(t.cart.final_total),card:t.cardInfo.number.split(" ").join("")},message:t.msg}};t.loadingPage=!0;const n=await I.submitOrder(o);n&&(window.$message.warning(n.data.message),n.data.success?(t.payment==="creditcard"&&await I.payOrder(n.data.orderId),await t.initInfo(),await t.getCart(),await setTimeout(()=>{s.push("/order/"+n.data.orderId)},1e3)):s.push("/cart")),t.loadingPage=!1},l=p(()=>t.userInfo.email.match(/^\w+((-\w+)|(\.\w+))*@[A-Za-z0-9]+((\.|-)[A-Za-z0-9]+)*\.[A-Za-z]+$/)),g=p(()=>Object.values(t.userInfo).every(o=>o!=="")),f=p(()=>Object.values(t.cardInfo).every(o=>o!=="")&&t.cardInfo.number.match(/[0-9]/gi).length===16&&t.cardInfo.valid.length===5&&t.cardInfo.cvv.length===3),h=p(()=>g.value&&l.value&&(t.payment!=="creditcard"||f.value));return{globalStore:t,nextBtnAllow:h,validCard(o){const n=o.target.value.match(/[0-9]/gi),c=[];if(o.target.value!==""){const w=n.slice(0,4),m=n.slice(4,8),u=n.slice(8,12),_=n.slice(12);w.length>0&&m.length>0&&u.length===0?c.push(w.join("")," ",m.join("")):u.length>0&&_.length===0?c.push(w.join("")," ",m.join("")," ",u.join("")):_.length>0&&c.push(w.join("")," ",m.join("")," ",u.join("")," ",_.join(""))}t.cardInfo.number=c.join("")},validThru(o){const n=o.target.value.match(/[0-9]/gi);o.target.value!==""&&n.length>2&&n.splice(2,0,"/"),t.cardInfo.valid=n!==null?n.join(""):""},goNext(){if(!g.value){window.$message.warning("Plz Finish Your Info :)");return}if(t.payment==="creditcard"&&!f.value){window.$message.warning("Plz Confirm Payment Info");return}if(!l.value){window.$message.warning("Wrong Email");return}console.log(1),window.$dialog.warning({title:"Confirm Submit Order ?",positiveText:"Sure !",negativeText:"No",blockScroll:!1,onPositiveClick:()=>{x()}})}}}},a=s=>(A("data-v-7fe1c1c3"),s=s(),T(),s),P=a(()=>e("h5",{class:"tw-text-lg tw-mb-5"},"Shipping Information",-1)),z={class:"tw-grid sm:tw-grid-cols-2 tw-gap-x-4 sm:tw-gap-x-8 tw-gap-y-5 sm:tw-px-4"},E={for:"infoName"},U=a(()=>e("span",{class:"tw-text-notice"},"*",-1)),F=a(()=>e("br",null,null,-1)),G={for:"infoTel"},L=a(()=>e("span",{class:"tw-text-notice"},"*",-1)),X=a(()=>e("br",null,null,-1)),Y={for:"infoEmail"},Z=a(()=>e("span",{class:"tw-text-notice"},"*",-1)),D=a(()=>e("br",null,null,-1)),J={for:"infoAdd"},K=a(()=>e("span",{class:"tw-text-notice"},"*",-1)),R=a(()=>e("br",null,null,-1)),W={for:"msg",class:"tw-col-span-2"},q=a(()=>e("br",null,null,-1)),H=a(()=>e("hr",{class:"tw-opacity-40 tw-mt-10 tw-mb-8"},null,-1)),Q=a(()=>e("h5",{class:"tw-text-lg"},"Payment Details",-1)),$={key:0,class:"tw-grid tw-grid-cols-6 tw-gap-4 sm:tw-gap-x-8 tw-gap-y-5 sm:tw-px-4 tw-mt-5"},tt={for:"creditcard",class:"tw-col-span-6 sm:tw-col-span-3"},et=a(()=>e("span",{class:"tw-text-notice"},"*",-1)),ot=a(()=>e("br",null,null,-1)),lt=["value"],at={for:"valid",class:"tw-col-span-4 sm:tw-col-span-2"},nt=a(()=>e("span",{class:"tw-text-notice"},"*",-1)),st=a(()=>e("br",null,null,-1)),rt=["value"],it={for:"cvv",class:"tw-col-span-2 sm:tw-col-span-1"},dt=a(()=>e("span",{class:"tw-text-notice"},"*",-1)),ct=a(()=>e("br",null,null,-1)),wt={key:1,class:"tw-text-lg"},mt=a(()=>e("p",{class:"tw-text-notice tw-mt-8"}," *If you Submit Order, you also agree with our Shop Terms & Conditions ",-1));function ut(s,t,x,l,g,f){const h=k("ShopLayout");return b(),N(h,{process:1,breadcrumb:"Checkout",nextBtn:"Submit Order",nextBtnAllow:l.nextBtnAllow,onOnGoNext:l.goNext},{content:V(()=>[P,e("div",z,[e("label",E,[r(" Full Name "),U,F,i(e("input",{class:"tw-text-primary tw-w-full tw-border tw-border-solid tw-rounded-md tw-py-1 tw-px-2","onUpdate:modelValue":t[0]||(t[0]=o=>l.globalStore.userInfo.name=o),type:"text",name:"name",id:"infoName",placeholder:"enter full name"},null,512),[[d,l.globalStore.userInfo.name]])]),e("label",G,[r(" Mobile Number "),L,X,i(e("input",{class:"tw-text-primary tw-w-full tw-border tw-border-solid tw-rounded-md tw-py-1 tw-px-2",maxlength:"16","onUpdate:modelValue":t[1]||(t[1]=o=>l.globalStore.userInfo.tel=o),type:"tel",name:"tel",id:"infoTel",placeholder:"e.g. 0900111222"},null,512),[[d,l.globalStore.userInfo.tel]])]),e("label",Y,[r(" E-mail "),Z,D,i(e("input",{class:"tw-text-primary tw-w-full tw-border tw-border-solid tw-rounded-md tw-py-1 tw-px-2","onUpdate:modelValue":t[2]||(t[2]=o=>l.globalStore.userInfo.email=o),type:"email",name:"email",id:"infoEmail",placeholder:"name@email.com"},null,512),[[d,l.globalStore.userInfo.email]])]),e("label",J,[r(" Address "),K,R,i(e("input",{class:"tw-text-primary tw-w-full tw-border tw-border-solid tw-rounded-md tw-py-1 tw-px-2","onUpdate:modelValue":t[3]||(t[3]=o=>l.globalStore.userInfo.add=o),type:"text",name:"address",id:"infoAdd",placeholder:"enter full address"},null,512),[[d,l.globalStore.userInfo.add]])]),e("label",W,[r(" Memo"),q,i(e("input",{class:"tw-text-primary tw-w-full tw-border tw-border-solid tw-rounded-md tw-py-1 tw-px-2","onUpdate:modelValue":t[4]||(t[4]=o=>l.globalStore.msg=o),type:"text",id:"msg"},null,512),[[d,l.globalStore.msg]])])]),H,Q,l.globalStore.payment==="creditcard"?(b(),y("div",$,[e("label",tt,[r(" Credit Card Number "),et,ot,e("input",{onInput:t[5]||(t[5]=o=>l.validCard(o)),class:"tw-text-primary tw-w-full tw-border tw-border-solid tw-rounded-md tw-py-1 tw-px-2",maxlength:"19",value:l.globalStore.cardInfo.number,type:"tel",id:"creditcard",placeholder:"1111 2222 3333 4444"},null,40,lt)]),e("label",at,[r(" Valid Thru "),nt,st,e("input",{onInput:t[6]||(t[6]=o=>l.validThru(o)),class:"tw-text-primary tw-w-full tw-border tw-border-solid tw-rounded-md tw-py-1 tw-px-2",maxlength:"5",value:l.globalStore.cardInfo.valid,type:"tel",id:"valid",placeholder:"MMYY"},null,40,rt)]),e("label",it,[r(" CVV "),dt,ct,i(e("input",{class:"tw-text-primary tw-w-full tw-border tw-border-solid tw-rounded-md tw-py-1 tw-px-2",maxlength:"3","onUpdate:modelValue":t[7]||(t[7]=o=>l.globalStore.cardInfo.cvv=o),type:"tel",id:"cvv",placeholder:"XXX"},null,512),[[d,l.globalStore.cardInfo.cvv]])])])):v("",!0),l.globalStore.payment==="atm"?(b(),y("p",wt," you will get a ATM account for pay this order in Next Page. ")):v("",!0),mt]),_:1},8,["nextBtnAllow","onOnGoNext"])}const xt=O(M,[["render",ut],["__scopeId","data-v-7fe1c1c3"]]);export{xt as default};
