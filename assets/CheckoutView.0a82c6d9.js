import{S as x}from"./ShopLayout.97f5ec35.js";import{a as y,y as v,o as I,c as S,d as h,h as C,w as j,f as e,i as c,k as w,L as p,e as _,l as b,p as N,m as V}from"./index.3fd88bf0.js";import{u as k}from"./global.efb0bcc0.js";import{_ as T}from"./_plugin-vue_export-helper.cdc0426e.js";import"./TheHeader.24b3d165.js";const P={components:{ShopLayout:x},setup(){const i=y(),l=v("axios"),o=k();I(()=>{var r;(((r=o.cart.carts)==null?void 0:r.length)===0||o.payment===""||o.shipping==="")&&(i.push("/"),window.$message.warning("Plz Add item first"))});const a=r=>{const s=`https://vue3-course-api.hexschool.io/api/daylily-api/pay/${r}`;l.post(s).then(t=>{if(t)return t}).catch(t=>{window.$message.error(t.toString())})},f=()=>{const r={data:{user:{name:o.userInfo.name,email:o.userInfo.email,tel:o.userInfo.tel,address:o.userInfo.add,payment_method:o.payment,shipping_method:o.shipping,shipping_money:o.shippingMoney,discount:o.cart.total-Math.ceil(o.cart.final_total),card:o.cardInfo.number.split(" ").join("")},message:o.msg}};o.loadingPage=!0;const s="https://vue3-course-api.hexschool.io/api/daylily-api/order";l.post(s,r).then(async t=>{t&&(window.$message.warning(t.data.message),t.data.success?(o.payment==="creditcard"&&await a(t.data.orderId),await o.initInfo(),await o.getCart(),await setTimeout(()=>{i.push("/order/"+t.data.orderId)},1e3)):i.push("/cart")),o.loadingPage=!1}).catch(t=>{window.$message.error(t.toString()),o.loadingPage=!1})};return{globalStore:o,validCard(r){const s=r.target.value.match(/[0-9]/gi),t=[];if(r.target.value!==""){const d=s.slice(0,4),m=s.slice(4,8),u=s.slice(8,12),g=s.slice(12);d.length>0&&m.length>0&&u.length===0?t.push(d.join("")," ",m.join("")):u.length>0&&g.length===0?t.push(d.join("")," ",m.join("")," ",u.join("")):g.length>0&&t.push(d.join("")," ",m.join("")," ",u.join("")," ",g.join(""))}o.cardInfo.number=t.join("")},validThru(r){const s=r.target.value.match(/[0-9]/gi);r.target.value!==""&&s.length>2&&s.splice(2,0,"/"),o.cardInfo.valid=s.join("")},goNext(){const r=/^\w+((-\w+)|(\.\w+))*@[A-Za-z0-9]+((\.|-)[A-Za-z0-9]+)*\.[A-Za-z]+$/;o.userInfo.email.match(r)||window.$message.warning("Wrong Email");const s=Object.values(o.userInfo).every(d=>d!=="");let t=!0;if(!s)window.$message.warning("Plz Finish Your Info :)");else if(o.payment==="creditcard"&&(t=Object.values(o.cardInfo).every(d=>d!==""),t&&o.cardInfo.number.match(/[0-9]/gi).length!==16||o.cardInfo.valid.length!==5||o.cardInfo.cvv.length!==3)){window.$message.warning("Plz Confirm Payment Info");return}s&&t&&window.$dialog.warning({title:"Confirm Submit Order ?",positiveText:"Sure !",negativeText:"No",blockScroll:!1,onPositiveClick:()=>{f()}})}}}},n=i=>(N("data-v-4de591c0"),i=i(),V(),i),A=n(()=>e("h5",{class:"tw-text-lg tw-mb-5"},"Shipping Information",-1)),M={class:"tw-grid sm:tw-grid-cols-2 tw-gap-x-4 sm:tw-gap-x-8 tw-gap-y-5 sm:tw-px-4"},O={for:"infoName"},z=n(()=>e("span",{class:"tw-text-notice"},"*",-1)),B=n(()=>e("br",null,null,-1)),E={for:"infoTel"},U=n(()=>e("span",{class:"tw-text-notice"},"*",-1)),F=n(()=>e("br",null,null,-1)),L={for:"infoEmail"},G=n(()=>e("span",{class:"tw-text-notice"},"*",-1)),X=n(()=>e("br",null,null,-1)),Y={for:"infoAdd"},Z=n(()=>e("span",{class:"tw-text-notice"},"*",-1)),D=n(()=>e("br",null,null,-1)),R={for:"msg",class:"tw-col-span-2"},W=n(()=>e("br",null,null,-1)),q=n(()=>e("hr",{class:"tw-opacity-40 tw-mt-10 tw-mb-8"},null,-1)),H=n(()=>e("h5",{class:"tw-text-lg"},"Payment Details",-1)),J={key:0,class:"tw-grid tw-grid-cols-6 tw-gap-4 sm:tw-gap-x-8 tw-gap-y-5 sm:tw-px-4 tw-mt-5"},K={for:"creditcard",class:"tw-col-span-6 sm:tw-col-span-3"},Q=n(()=>e("span",{class:"tw-text-notice"},"*",-1)),$=n(()=>e("br",null,null,-1)),tt=["value"],et={for:"valid",class:"tw-col-span-4 sm:tw-col-span-2"},ot=n(()=>e("span",{class:"tw-text-notice"},"*",-1)),at=n(()=>e("br",null,null,-1)),lt=["value"],nt={for:"cvv",class:"tw-col-span-2 sm:tw-col-span-1"},st=n(()=>e("span",{class:"tw-text-notice"},"*",-1)),rt=n(()=>e("br",null,null,-1)),it={key:1,class:"tw-text-lg"},dt=n(()=>e("p",{class:"tw-text-notice tw-mt-8"}," *If you Submit Order, you also agree with our Shop Terms & Conditions ",-1));function ct(i,l,o,a,f,r){const s=S("ShopLayout");return h(),C(s,{process:1,breadcrumb:"Checkout",nextBtn:"Submit Order",onOnGoNext:a.goNext},{content:j(()=>[A,e("div",M,[e("label",O,[c(" Full Name "),z,B,w(e("input",{class:"tw-text-primary tw-w-full tw-border tw-border-solid tw-rounded-md tw-py-1 tw-px-2","onUpdate:modelValue":l[0]||(l[0]=t=>a.globalStore.userInfo.name=t),type:"text",name:"name",id:"infoName",placeholder:"enter full name"},null,512),[[p,a.globalStore.userInfo.name]])]),e("label",E,[c(" Mobile Number "),U,F,w(e("input",{class:"tw-text-primary tw-w-full tw-border tw-border-solid tw-rounded-md tw-py-1 tw-px-2",maxlength:"16","onUpdate:modelValue":l[1]||(l[1]=t=>a.globalStore.userInfo.tel=t),type:"tel",name:"tel",id:"infoTel",placeholder:"e.g. 0900111222"},null,512),[[p,a.globalStore.userInfo.tel]])]),e("label",L,[c(" E-mail "),G,X,w(e("input",{class:"tw-text-primary tw-w-full tw-border tw-border-solid tw-rounded-md tw-py-1 tw-px-2","onUpdate:modelValue":l[2]||(l[2]=t=>a.globalStore.userInfo.email=t),type:"email",name:"email",id:"infoEmail",placeholder:"name@email.com"},null,512),[[p,a.globalStore.userInfo.email]])]),e("label",Y,[c(" Address "),Z,D,w(e("input",{class:"tw-text-primary tw-w-full tw-border tw-border-solid tw-rounded-md tw-py-1 tw-px-2","onUpdate:modelValue":l[3]||(l[3]=t=>a.globalStore.userInfo.add=t),type:"text",name:"address",id:"infoAdd",placeholder:"enter full address"},null,512),[[p,a.globalStore.userInfo.add]])]),e("label",R,[c(" Memo"),W,w(e("input",{class:"tw-text-primary tw-w-full tw-border tw-border-solid tw-rounded-md tw-py-1 tw-px-2","onUpdate:modelValue":l[4]||(l[4]=t=>a.globalStore.msg=t),type:"text",id:"msg"},null,512),[[p,a.globalStore.msg]])])]),q,H,a.globalStore.payment==="creditcard"?(h(),_("div",J,[e("label",K,[c(" Credit Card Number "),Q,$,e("input",{onInput:l[5]||(l[5]=t=>a.validCard(t)),class:"tw-text-primary tw-w-full tw-border tw-border-solid tw-rounded-md tw-py-1 tw-px-2",maxlength:"19",value:a.globalStore.cardInfo.number,type:"tel",id:"creditcard",placeholder:"1111 2222 3333 4444"},null,40,tt)]),e("label",et,[c(" Valid Thru "),ot,at,e("input",{onInput:l[6]||(l[6]=t=>a.validThru(t)),class:"tw-text-primary tw-w-full tw-border tw-border-solid tw-rounded-md tw-py-1 tw-px-2",maxlength:"5",value:a.globalStore.cardInfo.valid,type:"tel",id:"valid",placeholder:"MMYY"},null,40,lt)]),e("label",nt,[c(" CVV "),st,rt,w(e("input",{class:"tw-text-primary tw-w-full tw-border tw-border-solid tw-rounded-md tw-py-1 tw-px-2",maxlength:"3","onUpdate:modelValue":l[7]||(l[7]=t=>a.globalStore.cardInfo.cvv=t),type:"tel",id:"cvv",placeholder:"XXX"},null,512),[[p,a.globalStore.cardInfo.cvv]])])])):b("",!0),a.globalStore.payment==="atm"?(h(),_("p",it," you will get a ATM account for pay this order in Next Page. ")):b("",!0),dt]),_:1},8,["onOnGoNext"])}const ht=T(P,[["render",ct],["__scopeId","data-v-4de591c0"]]);export{ht as default};
