import{a as A,o as T,K as f,d as _,i as B,w as M,g as a,f as e,j as r,m as i,L as d,e as v,p as I,q as O,s as P}from"./index.b92c22bd.js";import{_ as $}from"./ShopLayout.4fefdd2a.js";import{a as C}from"./api.59f3b1c7.js";import{u as z}from"./global.07552095.js";import{_ as E}from"./plugin-vueexport-helper.2444895f.js";import"./TheHeader.6fbf11ff.js";const n=c=>(O("data-v-dd7abc89"),c=c(),P(),c),U=n(()=>e("h5",{class:"tw-text-lg tw-mb-5"},"Shipping Information",-1)),F={class:"tw-grid sm:tw-grid-cols-2 tw-gap-x-4 sm:tw-gap-x-8 tw-gap-y-5 sm:tw-px-4"},X={for:"infoName"},Y=n(()=>e("span",{class:"tw-text-notice"},"*",-1)),Z=n(()=>e("br",null,null,-1)),D={for:"infoTel"},G=n(()=>e("span",{class:"tw-text-notice"},"*",-1)),q=n(()=>e("br",null,null,-1)),K={for:"infoEmail"},L=n(()=>e("span",{class:"tw-text-notice"},"*",-1)),R=n(()=>e("br",null,null,-1)),W={for:"infoAdd"},H=n(()=>e("span",{class:"tw-text-notice"},"*",-1)),J=n(()=>e("br",null,null,-1)),Q={for:"msg",class:"tw-col-span-2"},tt=n(()=>e("br",null,null,-1)),et=n(()=>e("hr",{class:"tw-opacity-40 tw-mt-10 tw-mb-8"},null,-1)),ot=n(()=>e("h5",{class:"tw-text-lg"},"Payment Details",-1)),st={key:0,class:"tw-grid tw-grid-cols-6 tw-gap-4 sm:tw-gap-x-8 tw-gap-y-5 sm:tw-px-4 tw-mt-5"},nt={for:"creditCard",class:"tw-col-span-6 sm:tw-col-span-3"},at=n(()=>e("span",{class:"tw-text-notice"},"*",-1)),lt=n(()=>e("br",null,null,-1)),rt=["value"],it={for:"valid",class:"tw-col-span-4 sm:tw-col-span-2"},dt=n(()=>e("span",{class:"tw-text-notice"},"*",-1)),ct=n(()=>e("br",null,null,-1)),ut=["value"],wt={for:"cvv",class:"tw-col-span-2 sm:tw-col-span-1"},mt=n(()=>e("span",{class:"tw-text-notice"},"*",-1)),pt=n(()=>e("br",null,null,-1)),ft={key:1,class:"tw-text-lg"},gt=n(()=>e("p",{class:"tw-text-notice tw-mt-8"}," *If you Submit Order, you also agree with our Shop Terms & Conditions ",-1)),ht={__name:"CheckoutView",setup(c){const g=A(),t=z();T(()=>{var l;(((l=t.cart.carts)==null?void 0:l.length)===0||t.payment===""||t.shipping==="")&&(g.push("/"),window.$message.warning("Plz Add item first"))});const j=async()=>{const l={data:{user:{name:t.userInfo.name,email:t.userInfo.email,tel:t.userInfo.tel,address:t.userInfo.add,payment_method:t.payment,shipping_method:t.shipping,shipping_money:t.shippingMoney,discount:t.cart.total-Math.ceil(t.cart.final_total),card:t.cardInfo.number.split(" ").join("")},message:t.msg}};try{t.loadingPage=!0;const o=await C.submitOrder(l);o&&(console.log(o),window.$message.warning(o.data.message),o.data.success?(t.payment==="creditCard"&&await C.payOrder(o.data.orderId),await t.initInfo(),await t.getCart(),await setTimeout(()=>{g.push("/order/"+o.data.orderId)},1e3)):g.push("/cart")),t.loadingPage=!1}catch(o){window.$message.error(o.toString())}},b=f(()=>t.userInfo.email.match(/^\w+((-\w+)|(\.\w+))*@[A-Za-z0-9]+((\.|-)[A-Za-z0-9]+)*\.[A-Za-z]+$/)),x=f(()=>Object.values(t.userInfo).every(l=>l!=="")),y=f(()=>Object.values(t.cardInfo).every(l=>l!=="")&&t.cardInfo.number.match(/[0-9]/gi).length===16&&t.cardInfo.valid.length===5&&t.cardInfo.cvv.length===3),V=f(()=>x.value&&b.value&&(t.payment!=="creditCard"||y.value)),k=l=>{const o=l.target.value.match(/[0-9]/gi),s=o!==null?o:"",u=[];if(l.target.value!==""){const w=s.slice(0,4),m=s.slice(4,8),p=s.slice(8,12),h=s.slice(12);w.length>0&&m.length>0&&p.length===0?u.push(w.join("")," ",m.join("")):p.length>0&&h.length===0?u.push(w.join("")," ",m.join("")," ",p.join("")):h.length>0&&u.push(w.join("")," ",m.join("")," ",p.join("")," ",h.join(""))}t.cardInfo.number=u.join("")},N=l=>{const o=l.target.value.match(/[0-9]/gi),s=o!==null?o:"";s&&l.target.value!==""&&s.length>2&&s.splice(2,0,"/"),t.cardInfo.valid=s!==""?s.join(""):""},S=()=>{if(!x.value){window.$message.warning("Plz Finish Your Info :)");return}if(t.payment==="creditCard"&&!y.value){window.$message.warning("Plz Confirm Payment Info");return}if(!b.value){window.$message.warning("Wrong Email");return}console.log(1),window.$dialog.warning({title:"Confirm Submit Order ?",positiveText:"Sure !",negativeText:"No",blockScroll:!1,onPositiveClick:()=>{j()}})};return(l,o)=>(_(),B($,{process:1,breadcrumb:"Checkout",nextBtn:"Submit Order",nextBtnAllow:a(V),onOnGoNext:S},{content:M(()=>[U,e("div",F,[e("label",X,[r(" Full Name "),Y,Z,i(e("input",{class:"tw-text-primary tw-w-full tw-border tw-border-solid tw-rounded-md tw-py-1 tw-px-2","onUpdate:modelValue":o[0]||(o[0]=s=>a(t).userInfo.name=s),type:"text",name:"name",id:"infoName",placeholder:"enter full name"},null,512),[[d,a(t).userInfo.name]])]),e("label",D,[r(" Mobile Number "),G,q,i(e("input",{class:"tw-text-primary tw-w-full tw-border tw-border-solid tw-rounded-md tw-py-1 tw-px-2",maxlength:"16","onUpdate:modelValue":o[1]||(o[1]=s=>a(t).userInfo.tel=s),type:"tel",name:"tel",id:"infoTel",placeholder:"e.g. 0900111222"},null,512),[[d,a(t).userInfo.tel]])]),e("label",K,[r(" E-mail "),L,R,i(e("input",{class:"tw-text-primary tw-w-full tw-border tw-border-solid tw-rounded-md tw-py-1 tw-px-2","onUpdate:modelValue":o[2]||(o[2]=s=>a(t).userInfo.email=s),type:"email",name:"email",id:"infoEmail",placeholder:"name@email.com"},null,512),[[d,a(t).userInfo.email]])]),e("label",W,[r(" Address "),H,J,i(e("input",{class:"tw-text-primary tw-w-full tw-border tw-border-solid tw-rounded-md tw-py-1 tw-px-2","onUpdate:modelValue":o[3]||(o[3]=s=>a(t).userInfo.add=s),type:"text",name:"address",id:"infoAdd",placeholder:"enter full address"},null,512),[[d,a(t).userInfo.add]])]),e("label",Q,[r(" Memo"),tt,i(e("input",{class:"tw-text-primary tw-w-full tw-border tw-border-solid tw-rounded-md tw-py-1 tw-px-2","onUpdate:modelValue":o[4]||(o[4]=s=>a(t).msg=s),type:"text",id:"msg"},null,512),[[d,a(t).msg]])])]),et,ot,a(t).payment==="creditCard"?(_(),v("div",st,[e("label",nt,[r(" Credit Card Number "),at,lt,e("input",{onInput:o[5]||(o[5]=s=>k(s)),class:"tw-text-primary tw-w-full tw-border tw-border-solid tw-rounded-md tw-py-1 tw-px-2",maxlength:"19",value:a(t).cardInfo.number,type:"tel",id:"creditCard",placeholder:"1111 2222 3333 4444"},null,40,rt)]),e("label",it,[r(" Valid Thru "),dt,ct,e("input",{onInput:o[6]||(o[6]=s=>N(s)),class:"tw-text-primary tw-w-full tw-border tw-border-solid tw-rounded-md tw-py-1 tw-px-2",maxlength:"5",value:a(t).cardInfo.valid,type:"tel",id:"valid",placeholder:"MM YY"},null,40,ut)]),e("label",wt,[r(" CVV "),mt,pt,i(e("input",{class:"tw-text-primary tw-w-full tw-border tw-border-solid tw-rounded-md tw-py-1 tw-px-2",maxlength:"3","onUpdate:modelValue":o[7]||(o[7]=s=>a(t).cardInfo.cvv=s),type:"tel",id:"cvv",placeholder:"XXX"},null,512),[[d,a(t).cardInfo.cvv]])])])):I("",!0),a(t).payment==="atm"?(_(),v("p",ft," you will get a ATM account for pay this order in Next Page. ")):I("",!0),gt]),_:1},8,["nextBtnAllow"]))}},Ct=E(ht,[["__scopeId","data-v-dd7abc89"]]);export{Ct as default};
