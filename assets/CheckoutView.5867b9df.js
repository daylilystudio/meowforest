import{S as y}from"./ShopLayout.d3469889.js";import{a as x,x as v,o as I,b as S,c as g,h as C,w as j,f as t,i as c,J as p,K as u,e as _,k as b,p as N,l as V}from"./index.2e2974b4.js";import{u as k}from"./global.90d7dab6.js";import{_ as T}from"./_plugin-vue_export-helper.cdc0426e.js";import"./TheHeader.a4860dbd.js";const M={components:{ShopLayout:y},setup(){const d=x(),n=v("axios"),o=k();I(()=>{var s;(((s=o.cart.carts)==null?void 0:s.length)===0||o.payment===""||o.shipping==="")&&d.push("/")});const l=s=>{const r=`https://vue3-course-api.hexschool.io/api/daylily-api/pay/${s}`;n.post(r).then(e=>{if(e)return e}).catch(e=>{console.log(e)})},f=()=>{const s=new Date,r={data:{user:{name:o.userInfo.name,email:o.userInfo.email,tel:o.userInfo.tel,address:o.userInfo.add,payment_method:o.payment,shipping_method:o.shipping,shipping_money:o.shippingMoney,card:o.cardInfo.number.split(" ").join(""),date:{y:s.getFullYear(),m:s.getMonth()+1,d:s.getDate()}},message:o.msg}};o.loadingPage=!0;const e="https://vue3-course-api.hexschool.io/api/daylily-api/order";n.post(e,r).then(async i=>{i&&(window.$notification.warning({content:i.data.message,duration:2e3}),i.data.success?(o.payment==="creditcard"&&await l(i.data.orderId),await o.initInfo(),await o.getCart(),await setTimeout(()=>{d.push("/order/"+i.data.orderId)},1e3)):d.push("/cart")),o.loadingPage=!1}).catch(i=>{console.log(i),o.loadingPage=!1})};return{globalStore:o,validCard(s){const r=s.target.value.match(/[0-9]/gi),e=[];if(s.target.value!==""){const i=r.slice(0,4),m=r.slice(4,8),w=r.slice(8,12),h=r.slice(12);i.length>0&&m.length>0&&w.length===0?e.push(i.join("")," ",m.join("")):w.length>0&&h.length===0?e.push(i.join("")," ",m.join("")," ",w.join("")):h.length>0&&e.push(i.join("")," ",m.join("")," ",w.join("")," ",h.join(""))}o.cardInfo.number=e.join("")},validThru(s){const r=s.target.value.match(/[0-9]/gi);s.target.value!==""&&r.length>2&&r.splice(2,0,"/"),o.cardInfo.valid=r.join("")},goNext(){if(o.cardInfo.number.match(/[0-9]/gi).length!==16||o.cardInfo.valid.length!==5||o.cardInfo.cvv.length!==3){window.$notification.warning({content:"Please Confirm Payment Info",duration:2e3});return}const s=Object.values(o.userInfo).every(e=>e!==""),r=o.payment==="creditcard"?Object.values(o.cardInfo).every(e=>e!==""):!0;if(s&&r){window.$dialog.warning({title:"Confirm Submit Order ?",positiveText:"Sure !",negativeText:"No",blockScroll:!1,onPositiveClick:()=>{f()}});return}window.$notification.warning({content:"Plz finish your info :)",duration:3e3})}}}},a=d=>(N("data-v-60429241"),d=d(),V(),d),O=a(()=>t("h5",{class:"tw-text-lg tw-mb-5"},"Shipping Information",-1)),P={class:"tw-grid sm:tw-grid-cols-2 tw-gap-x-8 tw-gap-y-5 tw-px-4"},U={for:"infoName"},A=a(()=>t("span",{class:"text-second"},"*",-1)),B=a(()=>t("br",null,null,-1)),D={for:"infoTel"},E=a(()=>t("span",{class:"text-second"},"*",-1)),F=a(()=>t("br",null,null,-1)),G={for:"infoEmail"},X=a(()=>t("span",{class:"text-second"},"*",-1)),Y=a(()=>t("br",null,null,-1)),z={for:"infoAdd"},J=a(()=>t("span",{class:"text-second"},"*",-1)),K=a(()=>t("br",null,null,-1)),L={for:"msg",class:"tw-col-span-2"},R=a(()=>t("br",null,null,-1)),q=a(()=>t("hr",{class:"tw-opacity-40 tw-mt-10 tw-mb-8"},null,-1)),H=a(()=>t("h5",{class:"tw-text-lg"},"Payment Details",-1)),Q={key:0,class:"tw-grid tw-grid-cols-6 tw-gap-4 sm:tw-gap-x-8 tw-gap-y-5 tw-px-4 tw-mt-5"},W={for:"creditcard",class:"tw-col-span-6 sm:tw-col-span-3"},Z=a(()=>t("span",{class:"text-second"},"*",-1)),$=a(()=>t("br",null,null,-1)),tt=["value"],et={for:"valid",class:"tw-col-span-4 sm:tw-col-span-2"},ot=a(()=>t("span",{class:"text-second"},"*",-1)),lt=a(()=>t("br",null,null,-1)),nt=["value"],at={for:"cvv",class:"tw-col-span-2 sm:tw-col-span-1"},st=a(()=>t("span",{class:"text-second"},"*",-1)),rt=a(()=>t("br",null,null,-1)),it={key:1,class:"tw-text-lg"},dt=a(()=>t("p",{class:"text-second tw-mt-8"}," *If you Submit Order, you also agree with our Shop Terms & Conditions ",-1));function ct(d,n,o,l,f,s){const r=S("shop-layout");return g(),C(r,{process:1,breadcrumb:"Checkout",nextBtn:"Submit Order",onOnGoNext:l.goNext},{content:j(()=>[O,t("div",P,[t("label",U,[c(" Full Name "),A,B,p(t("input",{class:"text-primary tw-w-full tw-border tw-border-solid tw-rounded-md tw-py-1 tw-px-2","onUpdate:modelValue":n[0]||(n[0]=e=>l.globalStore.userInfo.name=e),type:"text",name:"name",id:"infoName",placeholder:"enter full name"},null,512),[[u,l.globalStore.userInfo.name]])]),t("label",D,[c(" Mobile Number "),E,F,p(t("input",{class:"text-primary tw-w-full tw-border tw-border-solid tw-rounded-md tw-py-1 tw-px-2",maxlength:"16","onUpdate:modelValue":n[1]||(n[1]=e=>l.globalStore.userInfo.tel=e),type:"tel",name:"tel",id:"infoTel",placeholder:"e.g. 0900111222"},null,512),[[u,l.globalStore.userInfo.tel]])]),t("label",G,[c(" E-mail "),X,Y,p(t("input",{class:"text-primary tw-w-full tw-border tw-border-solid tw-rounded-md tw-py-1 tw-px-2","onUpdate:modelValue":n[2]||(n[2]=e=>l.globalStore.userInfo.email=e),type:"email",name:"email",id:"infoEmail",placeholder:"name@email.com"},null,512),[[u,l.globalStore.userInfo.email]])]),t("label",z,[c(" Address "),J,K,p(t("input",{class:"text-primary tw-w-full tw-border tw-border-solid tw-rounded-md tw-py-1 tw-px-2","onUpdate:modelValue":n[3]||(n[3]=e=>l.globalStore.userInfo.add=e),type:"text",name:"address",id:"infoAdd",placeholder:"enter full address"},null,512),[[u,l.globalStore.userInfo.add]])]),t("label",L,[c(" Memo"),R,p(t("input",{class:"text-primary tw-w-full tw-border tw-border-solid tw-rounded-md tw-py-1 tw-px-2","onUpdate:modelValue":n[4]||(n[4]=e=>l.globalStore.msg=e),type:"text",id:"msg"},null,512),[[u,l.globalStore.msg]])])]),q,H,l.globalStore.payment==="creditcard"?(g(),_("div",Q,[t("label",W,[c(" Credit Card Number "),Z,$,t("input",{onInput:n[5]||(n[5]=e=>l.validCard(e)),class:"text-primary tw-w-full tw-border tw-border-solid tw-rounded-md tw-py-1 tw-px-2",maxlength:"19",value:l.globalStore.cardInfo.number,type:"tel",id:"creditcard",placeholder:"1111 2222 3333 4444"},null,40,tt)]),t("label",et,[c(" Valid Thru "),ot,lt,t("input",{onInput:n[6]||(n[6]=e=>l.validThru(e)),class:"text-primary tw-w-full tw-border tw-border-solid tw-rounded-md tw-py-1 tw-px-2",maxlength:"5",value:l.globalStore.cardInfo.valid,type:"tel",id:"valid",placeholder:"MMYY"},null,40,nt)]),t("label",at,[c(" CVV "),st,rt,p(t("input",{class:"text-primary tw-w-full tw-border tw-border-solid tw-rounded-md tw-py-1 tw-px-2",maxlength:"3","onUpdate:modelValue":n[7]||(n[7]=e=>l.globalStore.cardInfo.cvv=e),type:"tel",id:"cvv",placeholder:"XXX"},null,512),[[u,l.globalStore.cardInfo.cvv]])])])):b("",!0),l.globalStore.payment==="atm"?(g(),_("p",it," you will get a ATM account for pay this order in Next Page. ")):b("",!0),dt]),_:1},8,["onOnGoNext"])}const gt=T(M,[["render",ct],["__scopeId","data-v-60429241"]]);export{gt as default};
