import{a as A,o as N,J as m,d as g,i as T,w as B,g as a,f as e,j as r,l as i,K as d,e as y,m as v,p as M,q as O}from"./index.a6041f1b.js";import{S as P}from"./ShopLayout.e647b383.js";import{a as I}from"./api.a81b7417.js";import{u as $}from"./global.df7fc7dc.js";import{_ as z}from"./_plugin-vue_export-helper.cdc0426e.js";import"./TheHeader.d1f1df2b.js";const n=c=>(M("data-v-a7b4ca2d"),c=c(),O(),c),E=n(()=>e("h5",{class:"tw-text-lg tw-mb-5"},"Shipping Information",-1)),U={class:"tw-grid sm:tw-grid-cols-2 tw-gap-x-4 sm:tw-gap-x-8 tw-gap-y-5 sm:tw-px-4"},F={for:"infoName"},X=n(()=>e("span",{class:"tw-text-notice"},"*",-1)),Y=n(()=>e("br",null,null,-1)),Z={for:"infoTel"},D=n(()=>e("span",{class:"tw-text-notice"},"*",-1)),G=n(()=>e("br",null,null,-1)),q={for:"infoEmail"},J=n(()=>e("span",{class:"tw-text-notice"},"*",-1)),K=n(()=>e("br",null,null,-1)),L={for:"infoAdd"},R=n(()=>e("span",{class:"tw-text-notice"},"*",-1)),W=n(()=>e("br",null,null,-1)),H={for:"msg",class:"tw-col-span-2"},Q=n(()=>e("br",null,null,-1)),tt=n(()=>e("hr",{class:"tw-opacity-40 tw-mt-10 tw-mb-8"},null,-1)),et=n(()=>e("h5",{class:"tw-text-lg"},"Payment Details",-1)),ot={key:0,class:"tw-grid tw-grid-cols-6 tw-gap-4 sm:tw-gap-x-8 tw-gap-y-5 sm:tw-px-4 tw-mt-5"},st={for:"creditcard",class:"tw-col-span-6 sm:tw-col-span-3"},nt=n(()=>e("span",{class:"tw-text-notice"},"*",-1)),at=n(()=>e("br",null,null,-1)),lt=["value"],rt={for:"valid",class:"tw-col-span-4 sm:tw-col-span-2"},it=n(()=>e("span",{class:"tw-text-notice"},"*",-1)),dt=n(()=>e("br",null,null,-1)),ct=["value"],ut={for:"cvv",class:"tw-col-span-2 sm:tw-col-span-1"},wt=n(()=>e("span",{class:"tw-text-notice"},"*",-1)),pt=n(()=>e("br",null,null,-1)),mt={key:1,class:"tw-text-lg"},ft=n(()=>e("p",{class:"tw-text-notice tw-mt-8"}," *If you Submit Order, you also agree with our Shop Terms & Conditions ",-1)),ht={__name:"CheckoutView",setup(c){const f=A(),t=$();N(()=>{var l;(((l=t.cart.carts)==null?void 0:l.length)===0||t.payment===""||t.shipping==="")&&(f.push("/"),window.$message.warning("Plz Add item first"))});const C=async()=>{const l={data:{user:{name:t.userInfo.name,email:t.userInfo.email,tel:t.userInfo.tel,address:t.userInfo.add,payment_method:t.payment,shipping_method:t.shipping,shipping_money:t.shippingMoney,discount:t.cart.total-Math.ceil(t.cart.final_total),card:t.cardInfo.number.split(" ").join("")},message:t.msg}};t.loadingPage=!0;const o=await I.submitOrder(l);o&&(window.$message.warning(o.data.message),o.data.success?(t.payment==="creditcard"&&await I.payOrder(o.data.orderId),await t.initInfo(),await t.getCart(),await setTimeout(()=>{f.push("/order/"+o.data.orderId)},1e3)):f.push("/cart")),t.loadingPage=!1},_=m(()=>t.userInfo.email.match(/^\w+((-\w+)|(\.\w+))*@[A-Za-z0-9]+((\.|-)[A-Za-z0-9]+)*\.[A-Za-z]+$/)),b=m(()=>Object.values(t.userInfo).every(l=>l!=="")),x=m(()=>Object.values(t.cardInfo).every(l=>l!=="")&&t.cardInfo.number.match(/[0-9]/gi).length===16&&t.cardInfo.valid.length===5&&t.cardInfo.cvv.length===3),j=m(()=>b.value&&_.value&&(t.payment!=="creditcard"||x.value)),V=l=>{const o=l.target.value.match(/[0-9]/gi),s=[];if(l.target.value!==""){const u=o.slice(0,4),w=o.slice(4,8),p=o.slice(8,12),h=o.slice(12);u.length>0&&w.length>0&&p.length===0?s.push(u.join("")," ",w.join("")):p.length>0&&h.length===0?s.push(u.join("")," ",w.join("")," ",p.join("")):h.length>0&&s.push(u.join("")," ",w.join("")," ",p.join("")," ",h.join(""))}t.cardInfo.number=s.join("")},k=l=>{const o=l.target.value.match(/[0-9]/gi);l.target.value!==""&&o.length>2&&o.splice(2,0,"/"),t.cardInfo.valid=o!==null?o.join(""):""},S=()=>{if(!b.value){window.$message.warning("Plz Finish Your Info :)");return}if(t.payment==="creditcard"&&!x.value){window.$message.warning("Plz Confirm Payment Info");return}if(!_.value){window.$message.warning("Wrong Email");return}console.log(1),window.$dialog.warning({title:"Confirm Submit Order ?",positiveText:"Sure !",negativeText:"No",blockScroll:!1,onPositiveClick:()=>{C()}})};return(l,o)=>(g(),T(P,{process:1,breadcrumb:"Checkout",nextBtn:"Submit Order",nextBtnAllow:a(j),onOnGoNext:S},{content:B(()=>[E,e("div",U,[e("label",F,[r(" Full Name "),X,Y,i(e("input",{class:"tw-text-primary tw-w-full tw-border tw-border-solid tw-rounded-md tw-py-1 tw-px-2","onUpdate:modelValue":o[0]||(o[0]=s=>a(t).userInfo.name=s),type:"text",name:"name",id:"infoName",placeholder:"enter full name"},null,512),[[d,a(t).userInfo.name]])]),e("label",Z,[r(" Mobile Number "),D,G,i(e("input",{class:"tw-text-primary tw-w-full tw-border tw-border-solid tw-rounded-md tw-py-1 tw-px-2",maxlength:"16","onUpdate:modelValue":o[1]||(o[1]=s=>a(t).userInfo.tel=s),type:"tel",name:"tel",id:"infoTel",placeholder:"e.g. 0900111222"},null,512),[[d,a(t).userInfo.tel]])]),e("label",q,[r(" E-mail "),J,K,i(e("input",{class:"tw-text-primary tw-w-full tw-border tw-border-solid tw-rounded-md tw-py-1 tw-px-2","onUpdate:modelValue":o[2]||(o[2]=s=>a(t).userInfo.email=s),type:"email",name:"email",id:"infoEmail",placeholder:"name@email.com"},null,512),[[d,a(t).userInfo.email]])]),e("label",L,[r(" Address "),R,W,i(e("input",{class:"tw-text-primary tw-w-full tw-border tw-border-solid tw-rounded-md tw-py-1 tw-px-2","onUpdate:modelValue":o[3]||(o[3]=s=>a(t).userInfo.add=s),type:"text",name:"address",id:"infoAdd",placeholder:"enter full address"},null,512),[[d,a(t).userInfo.add]])]),e("label",H,[r(" Memo"),Q,i(e("input",{class:"tw-text-primary tw-w-full tw-border tw-border-solid tw-rounded-md tw-py-1 tw-px-2","onUpdate:modelValue":o[4]||(o[4]=s=>a(t).msg=s),type:"text",id:"msg"},null,512),[[d,a(t).msg]])])]),tt,et,a(t).payment==="creditcard"?(g(),y("div",ot,[e("label",st,[r(" Credit Card Number "),nt,at,e("input",{onInput:o[5]||(o[5]=s=>V(s)),class:"tw-text-primary tw-w-full tw-border tw-border-solid tw-rounded-md tw-py-1 tw-px-2",maxlength:"19",value:a(t).cardInfo.number,type:"tel",id:"creditcard",placeholder:"1111 2222 3333 4444"},null,40,lt)]),e("label",rt,[r(" Valid Thru "),it,dt,e("input",{onInput:o[6]||(o[6]=s=>k(s)),class:"tw-text-primary tw-w-full tw-border tw-border-solid tw-rounded-md tw-py-1 tw-px-2",maxlength:"5",value:a(t).cardInfo.valid,type:"tel",id:"valid",placeholder:"MMYY"},null,40,ct)]),e("label",ut,[r(" CVV "),wt,pt,i(e("input",{class:"tw-text-primary tw-w-full tw-border tw-border-solid tw-rounded-md tw-py-1 tw-px-2",maxlength:"3","onUpdate:modelValue":o[7]||(o[7]=s=>a(t).cardInfo.cvv=s),type:"tel",id:"cvv",placeholder:"XXX"},null,512),[[d,a(t).cardInfo.cvv]])])])):v("",!0),a(t).payment==="atm"?(g(),y("p",mt," you will get a ATM account for pay this order in Next Page. ")):v("",!0),ft]),_:1},8,["nextBtnAllow"]))}},It=z(ht,[["__scopeId","data-v-a7b4ca2d"]]);export{It as default};
